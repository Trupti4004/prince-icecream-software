<!DOCTYPE html>
<html>
<head>
    <title>Prince Ice Cream ‚Äì Wholesale Billing</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<header>
    üç¶ Prince Ice Cream ‚Äì Wholesale Billing & Payments
</header>

<div class="container">

    <!-- MASTER SECTION -->
    <div class="flex">
        <div class="card">
            <h3>Add Vendor</h3>
            <form method="post">
                <input type="text" name="new_vendor" placeholder="Vendor Name" required>
                <button>Add Vendor</button>
            </form>
        </div>

        <div class="card">
            <h3>Add Product</h3>
            <form method="post">
                <input type="text" name="new_product" placeholder="Product Name" required>
                <button>Add Product</button>
            </form>
        </div>
    </div>

    <!-- PURCHASE ENTRY -->
    <div class="card">
        <h3>Purchase Entry</h3>
        <form method="post">
            <label>Vendor</label>
            <select name="vendor" required>
                {% for v in vendors %}
                <option value="{{ v[0] }}">{{ v[0] }}</option>
                {% endfor %}
            </select>

            <label>Product</label>
            <select name="product" required>
                {% for p in products %}
                <option value="{{ p[0] }}">{{ p[0] }}</option>
                {% endfor %}
            </select>

            <label>Purchase Date</label>
            <input type="date" name="purchase_date" required>

            <label>Total Amount</label>
            <input type="number" name="total_amount" required>

            <label>Advance Received</label>
            <input type="number" name="advance" required>

            <button>Save Entry</button>
        </form>
    </div>

    <!-- FILTER -->
    <div class="card">
        <h3>Filter Records</h3>
        <form method="get" class="flex">
            <div>
                <label>Vendor</label>
                <select name="filter_vendor">
                    <option value="">All Vendors</option>
                    {% for v in vendors %}
                    <option value="{{ v[0] }}">{{ v[0] }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label>From Date</label>
                <input type="date" name="from_date">
            </div>

            <div>
                <label>To Date</label>
                <input type="date" name="to_date">
            </div>

            <div style="align-self:end;">
                <button>Apply Filter</button>
            </div>
        </form>
    </div>

    <!-- RECORDS -->
    <div class="card">
        <h3>Purchase Records</h3>
        <table>
            <tr>
                <th>Vendor</th>
                <th>Product</th>
                <th>Date</th>
                <th>Total</th>
                <th>Advance</th>
                <th>Pending</th>
                <th>Status</th>
                <th>Payment</th>
            </tr>

            {% for row in purchases %}
            <tr>
                <td>{{ row[1] }}</td>
                <td>{{ row[2] }}</td>
                <td>{{ row[3] }}</td>
                <td>‚Çπ{{ row[4] }}</td>
                <td>‚Çπ{{ row[5] }}</td>
                <td>‚Çπ{{ row[6] }}</td>
                <td>
                    {% if row[7] == "Pending" %}
                        <span class="status-pending">Pending</span>
                    {% else %}
                        <span class="status-cleared">Cleared</span>
                    {% endif %}
                </td>
                <td>
                    {% if row[7] == "Pending" %}
                    <form method="post" style="display:flex; gap:6px;">
                        <input type="hidden" name="pay_id" value="{{ row[0] }}">
                        <input type="number" name="received_amount" placeholder="Amount" required>
                        <button>Update</button>
                    </form>
                    {% else %}
                        ‚úî
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>

</div>

<div class="footer">
    ¬© Prince Ice Cream | Wholesale Billing System
</div>

</body>
</html>
