<!DOCTYPE html>
<html>
<head>
    <title>Prince Ice Cream ‚Äì Vendor Sales</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="container">

    <h1>üç¶ Prince Ice Cream Dashboard
        <a href="/logout" class="logout">Logout</a>
    </h1>

    <!-- ================= DASHBOARD CARDS ================= -->
    <div class="cards">
        <div class="card blue">
            <h3>Total Amount</h3>
            <h1>‚Çπ {{ total_amt }}</h1>
        </div>

        <div class="card green">
            <h3>Received</h3>
            <h1>‚Çπ {{ received_amt }}</h1>
        </div>

        <div class="card red">
            <h3>Pending</h3>
            <h1>‚Çπ {{ pending_amt }}</h1>
        </div>
    </div>

    <!-- ================= FILTER ================= -->
    <div class="section">
        <h2>Filter</h2>
        <form method="get">
            <select name="vendor">
                <option value="">All Vendors</option>
                {% for v in vendors %}
                <option value="{{ v[0] }}">{{ v[0] }}</option>
                {% endfor %}
            </select>

            <input type="date" name="from">
            <input type="date" name="to">

            <button type="submit">Apply Filter</button>
        </form>
    </div>

    <!-- ================= MASTERS ================= -->
    <div class="cards">

        <!-- Vendor Master -->
        <div class="card">
            <h3>Vendor Master</h3>
            <form method="post">
                <input name="new_vendor" placeholder="Vendor name" required>
                <button>Add</button>
            </form>
        </div>

        <!-- Product Master -->
        <div class="card">
            <h3>Product Master</h3>
            <form method="post">
                <input name="new_product" placeholder="Product name" required>
                <button>Add</button>
            </form>
        </div>

        <!-- Rate Master -->
        <div class="card">
            <h3>Rate Master</h3>
            <form method="post">
                <select name="rate_product">
                    {% for p in products %}
                    <option>{{ p[0] }}</option>
                    {% endfor %}
                </select>
                <input name="rate" placeholder="Rate" required>
                <button>Add</button>
            </form>
        </div>

    </div>

    <!-- ================= PURCHASE ENTRY ================= -->
    <div class="section">
        <h2>Vendor Product Entry</h2>
        <form method="post">
            <select name="vendor" required>
                {% for v in vendors %}
                <option>{{ v[0] }}</option>
                {% endfor %}
            </select>

            <select name="product" required>
                {% for p in products %}
                <option>{{ p[0] }}</option>
                {% endfor %}
            </select>

            <input name="quantity" placeholder="Quantity" required>
            <input name="paid" placeholder="Paid Amount" value="0">
            <input type="date" name="date" required>

            <button type="submit">Save Entry</button>
        </form>
    </div>

    <!-- ================= SALES TABLE ================= -->
    <div class="section">
        <h2>Vendor-wise Product Sales</h2>

        <table>
            <tr>
                <th>Vendor</th>
                <th>Product</th>
                <th>Qty</th>
                <th>Total</th>
                <th>Paid</th>
                <th>Pending</th>
                <th>Status</th>
                <th>Action</th>
            </tr>

            {% for r in sales %}
            <tr>
                <td>{{ r[1] }}</td>
                <td>{{ r[2] }}</td>
                <td>{{ r[3] }}</td>
                <td>‚Çπ {{ r[5] }}</td>
                <td>‚Çπ {{ r[6] }}</td>
                <td>‚Çπ {{ r[7] }}</td>
                <td>
                    {% if r[9] == "Pending" %}
                    <span class="badge pending">Pending</span>
                    {% else %}
                    <span class="badge cleared">Cleared</span>
                    {% endif %}
                </td>
                <td>
                    {% if r[9] == "Pending" %}
                    <form method="post" style="display:flex; gap:5px;">
                        <input type="hidden" name="pay_id" value="{{ r[0] }}">
                        <input name="received" placeholder="Pay" style="width:70px;">
                        <button>Update</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>

</div>

</body>
</html>
